<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ICU::RatedPlayer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ICU::RatedPlayer</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/icu_ratings/player_rb.html">
                lib/icu_ratings/player.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h2>Adding Players to Tournaments</h2>
<p>
You don&#8216;t directly create players, rather you add them to tournaments
with the <em>add_player</em> method.
</p>
<pre>
  t = ICU::RatedTournament.new
  t.add_player(1)
</pre>
<p>
There is only one mandatory parameter - the player number - which can be
any integer value except player numbers must be unique in each tournament:
</p>
<pre>
  t.add_player(2)    # fine
  t.add_player(2)    # attempt to add a second player with the same number - exception!
</pre>
<h2>Retrieving Players from Tournaments</h2>
<p>
Player objects can be retrieved from <a
href="RatedTournament.html">ICU::RatedTournament</a> objects with the
latter&#8216;s <em>player</em> method in conjunction with the appropriate
player number:
</p>
<pre>
  p = t.player(2)
  p.num              # 2
</pre>
<p>
Or the player object can be saved from the return value from
<em>add_player</em>:
</p>
<pre>
  p = t.add_player(-2)
  p.num             # -2
</pre>
<p>
If the number supplied to <em>player</em> is an invalid player number, the
method returns <em>nil</em>.
</p>
<p>
Different types of players are signalled by different combinations of the
three optional parameters: <em>rating</em>, <em>kfactor</em> and
<em>games</em>.
</p>
<h2>Full Ratings</h2>
<p>
Rated players have a full rating and a K-factor and are added by including
valid values for those two parameters:
</p>
<pre>
  p = t.add_player(3, :rating =&gt; 2000, :kfactor =&gt; 16)
  p.type             # :rated
</pre>
<h2>Provisional Ratings</h2>
<p>
Players that don&#8216;t yet have a full rating but do have a provisonal
rating estimated on some number of games played prior to the tournament are
indicated by values for the <em>rating</em> and <em>games</em> parameters:
</p>
<pre>
  p = t.add_player(4, :rating =&gt; 1600, :games =&gt; 10)
  p.type             # :provisional
</pre>
<p>
The value for the number of games should not exceed 19 since players with
20 or more games should have a full rating.
</p>
<h2>Fixed Ratings</h2>
<p>
Players with fixed ratings just have a rating - no K-factor or number of
previous games. When the tournament is rated, these players will have their
tournament <a href="RatedPlayer.html#M000015">performance</a> ratings
calculated but the value returned by the method <em><a
href="RatedPlayer.html#M000012">new_rating</a></em> will just be the rating
they started with. Typically these are foreign players with FIDE ratings
who are not members of the <a href="../ICU.html">ICU</a> and for whom <a
href="../ICU.html">ICU</a> ratings are not desired.
</p>
<pre>
  p = t.add_player(6, :rating =&gt; 2500)
  p.type             # :foreign
</pre>
<h2>No Rating</h2>
<p>
Unrated players who do not have any rated games at all are indicated by
leaving out any values for <em>rating</em>, <em>kfactor</em> or
<em>games</em>.
</p>
<pre>
  p = t.add_player(5)
  p.type             # :unrated
</pre>
<h2>Invalid Combinations</h2>
<p>
The above four types of players (<em>rated</em>, <em>provisional</em>,
<em>unrated</em>, <em>foreign</em>) are the only valid ones and any attempt
to add players with other combinations of the attributes <em>rating</em>,
<em>kfactor</em> and <em>games</em> will cause an exception. For example:
</p>
<pre>
  t.add_player(7, :rating =&gt; 2000, :kfactor =&gt; 16, :games =&gt; 10)   # exception! - cannot have both kfactor and games
  t.add_plater(7, :kfactor =&gt; 16)                                  # exception! - kfactor makes no sense without a rating
</pre>
<h2>String Input Values</h2>
<p>
Although <em>rating</em> and <em>kfactor</em> are held as Float values and
<em>games</em> and <em>num</em> (the player number) as Fixnums, all these
parameters can be specified using strings, even when padded with
whitespace.
</p>
<pre>
  p = t.add_player(&quot;  0  &quot;, :rating =&gt; &quot;  2000.5  &quot;, :kfactor =&gt; &quot;  20.5  &quot;)
  p.num            # 0 (Fixnum)
  p.rating         # 2000.5 (Float)
  p.kfactor        # 20.5 (Float)
</pre>
<h2>Description Parameter</h2>
<p>
There is one other optional parameter, <em>desc</em> (short for
&quot;description&quot;). It has no effect on player <a
href="RatedPlayer.html#M000018">type</a> or rating calculations and it
cannot be used to retrieve players from a tournament (only the player
number can be used for that). Its only use is to attach additional arbitary
data to players. Any object can be used and descriptions don&#8216;t have
to be unique. The attribute&#8216;s typical use, if it&#8216;s used at all,
is expected to be for player names in the form of String values.
</p>
<pre>
  t.add_player(8, :rating =&gt; 2800, :desc =&gt; 'Gary Kasparov (4100018)')
  t.player(8).desc    # &quot;Gary Kasparov (4100018)&quot;
</pre>
<h2>After the Tournament is Rated</h2>
<p>
After the <em>rate!</em> method has been called on the <a
href="RatedTournament.html">ICU::RatedTournament</a> object, the <a
href="RatedPlayer.html#M000016">results</a> of the rating calculations are
available via various methods of the player objects: <em><a
href="RatedPlayer.html#M000012">new_rating</a></em>, <em><a
href="RatedPlayer.html#M000013">rating_change</a></em>, <em><a
href="RatedPlayer.html#M000015">performance</a></em>, <em><a
href="RatedPlayer.html#M000014">expected_score</a></em>.
</p>
<h2>Unrateable Players</h2>
<p>
If a tournament contains groups of provisonal or unrated players who play
games only amongst themselves and not against any rated or foreign
opponents, they can&#8216;t be rated. This is indicated by a value of
<em>nil</em> returned from the <em><a
href="RatedPlayer.html#M000012">new_rating</a></em> method.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000014">expected_score</a>&nbsp;&nbsp;
      <a href="#M000012">new_rating</a>&nbsp;&nbsp;
      <a href="#M000015">performance</a>&nbsp;&nbsp;
      <a href="#M000013">rating_change</a>&nbsp;&nbsp;
      <a href="#M000016">results</a>&nbsp;&nbsp;
      <a href="#M000017">score</a>&nbsp;&nbsp;
      <a href="#M000018">type</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">desc</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">games</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">kfactor</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">num</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">rating</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000014.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000014.html');return false;">
          <span class="method-name">expected_score</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
After the tournament has been rated, this returns the sum of expected
scores over all <a href="RatedPlayer.html#M000016">results</a>. Although
this is calculated for provisional and unrated players it is not used to
estimate their new ratings. For rated players, this number times the
K-factor gives the change in rating.
</p>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000012.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000012.html');return false;">
          <span class="method-name">new_rating</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
After the tournament has been rated, this is the player&#8216;s new rating.
For rated players this is the old rating plus the <em><a
href="RatedPlayer.html#M000013">rating_change</a></em>. For provisional
players it is their <a href="RatedPlayer.html#M000015">performance</a>
rating, including their previous games. For unrated players it is their
tournament <a href="RatedPlayer.html#M000015">performance</a> rating. For
foreign players it is the same as their start <em>rating</em>.
</p>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000015.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000015.html');return false;">
          <span class="method-name">performance</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
After the tournament has been rated, this returns the tournament rating <a
href="RatedPlayer.html#M000015">performance</a> for rated, unrated and
foreign players. For provisional players it returns a weighted average of
the player&#8216;s tournament <a
href="RatedPlayer.html#M000015">performance</a> and their previous games.
For provisional and unrated players it is the same as <em><a
href="RatedPlayer.html#M000012">new_rating</a></em>.
</p>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000013.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000013.html');return false;">
          <span class="method-name">rating_change</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
After the tournament has been rated, this is the difference between the old
and new ratings for rated players, based on sum of expected scores in each
games and the player&#8216;s K-factor. Zero for all other types of players.
</p>
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000016.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000016.html');return false;">
          <span class="method-name">results</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of the player&#8216;s <a
href="RatedPlayer.html#M000016">results</a> (<a
href="RatedResult.html">ICU::RatedResult</a>) in round order.
</p>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000017.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000017.html');return false;">
          <span class="method-name">score</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The sum of the player&#8216;s scores in all rounds in which they have a
result.
</p>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="RatedPlayer.src/M000018.html" target="Code" class="method-signature"
            onclick="popupCode('RatedPlayer.src/M000018.html');return false;">
          <span class="method-name">type</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="RatedPlayer.html#M000018">type</a> of player as a
symbol: one of <em>rated</em>, <em>provisional</em>, <em>unrated</em> or
<em>foreign</em>.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>